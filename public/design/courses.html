<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <script>
        if (document.cookie.indexOf('user_is_admin=true') === -1) {
            /* Google Tag Manager */
            (function(w,d,s,l,i) {
                w[l]=w[l]||[];w[l].push({'gtm.start':
                        new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
                    j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
                    'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
            })(window,document,'script','dataLayer','GTM-WG2XFBS');

            /* Google Analytics */
            let anScript = document.createElement('script');
            let firstScript = document.getElementsByTagName('script')[0];
            anScript.async = true;
            anScript.src = 'https://www.googletagmanager.com/gtag/js?id=UA-113216929-1';
            firstScript.parentNode.insertBefore(anScript,firstScript);

            window.dataLayer = window.dataLayer || [];
            function gtag(){dataLayer.push(arguments);}
            gtag('js', new Date());
            gtag('config', 'UA-113216929-1');
        }
    </script>

    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.1.0/css/bootstrap.min.css" type="text/css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.4.5/css/swiper.min.css">
    <link rel="stylesheet" href="/assets/design/base.css" type="text/css">
    <link rel="stylesheet" href="/assets/design/desktop-override.css" type="text/css">
    <link rel="stylesheet" href="/assets/design/survey.css" type="text/css">

    <meta property="og:type" content="website"/>
    <meta property="og:title" content="Жажда знаний: найди свой курс"/>
    <meta property="og:image" content="/assets/images/banner_01.png"/>

    <title>Жажда знаний: найди свой курс</title>
</head>
<body>

<div id="app-root">
    <div class="view-on-desktop d-none d-sm-block d-md-block">
        <header class="">
            <div class="container wide-container d-flex align-items-center px-3 mb-3">
                <a href="/"><img src="/assets/images/itcher.png" class="mr-2"></a>
                <section class="data flex-fill">
                    <div class="input-group">
                        <label class="request">
                            &mdash;&nbsp;Я
                            <span class="dropdown">
                                <a href="#" class="editable-toggle mr-1" data-menu="profession" @click="toggleRequest('profession')">новичок</a>
                                <span class="dropdown-menu" :class="{'show': isRequestShown.profession}">
                                    <a class="dropdown-item" href="#">новичок</a>
                                    <a class="dropdown-item profession-title" href="#">...</a>
                                    <a class="dropdown-item" href="#">специалист из другой области</a>
                                </span>
                            </span>
                            <span class="dropdown">
                                <a href="#" class="editable-toggle work-experience-input-display" data-menu="exp" @click="toggleRequest('exp')">без опыта работы</a>
                                <span class="dropdown-menu" :class="{'show': isRequestShown.exp}">
                                    <a class="dropdown-item" href="#">без опыта работы</a>
                                    <a class="dropdown-item" href="#">с опытом работы до 3 лет</a>
                                    <a class="dropdown-item" href="#">с опытом работы 3 или более года</a>
                                </span>
                            </span>
                            хочу
                            <span class="dropdown">
                                <a href="#" class="editable-toggle want-to-input" data-menu="want" @click="toggleRequest('want')">стать <span class="profession-title-tp"></span></a>
                                <span class="dropdown-menu" :class="{'show': isRequestShown.want}">
                                    <a class="dropdown-item" href="#">стать <span class="profession-title-tp"></span></a>
                                    <a class="dropdown-item" href="#">начать с нуля</a>
                                    <a class="dropdown-item" href="#">продолжить обучение</a>
                                    <a class="dropdown-item" href="#">повысить квалификацию</a>
                                    <a class="dropdown-item" href="#">прокачать навык</a>
                                </span>
                            </span>
                            <button class="btn btn-outline-info apply-request" style="display: none">Подобрать курсы</button>
                        </label>
                    </div>
                </section>
                <section class="fav-auth d-flex align-items-center">
                    <div class="d-flex align-items-center dropdown dropleft">
                        <button id="desktop-fav-btn" class="btn btn-favourites-list d-flex align-items-center justify-content-center mr-4" @click="toggleFavourites">
                            <label class="fav-text">Мои&nbsp;курсы</label>
                            <i class="fas fa-bookmark mx-2"></i>
                            <span class="fav-count">0</span>
                        </button>
                        <div class="dropdown-menu favourite-list p-4" aria-labelledby="desktop-fav-btn" :class="{'show': isFavouritesShown}"></div>
                        <div class="dropdown-backdrop" @click="toggleFavourites"></div>
                    </div>
                    <img src="/assets/images/avatar.svg" class="auth-trigger avatar-holder">
                    <a href="#" class="auth-triggrer btn btn-link authed-remove">Войти</a>
                </section>
            </div>
        </header>
        <header class="scroll">
            <div class="container wide-container d-flex align-items-center px-3">
                <a class="" href="/"><img src="/assets/images/itcher-float.png" class="mr-2"></a>
                <section class="data flex-fill">
                    <div class="input-group">
                        <label class="request">
                            &mdash;&nbsp;Я
                            <span class="dropdown">
                                <a href="#" class="editable-toggle mr-1" data-menu="profession" @click="toggleRequest('profession')">новичок</a>
                                <span class="dropdown-menu" :class="{'show': isRequestShown.profession}">
                                    <a class="dropdown-item" href="#">новичок</a>
                                    <a class="dropdown-item profession-title" href="#">...</a>
                                    <a class="dropdown-item" href="#">специалист из другой области</a>
                                </span>
                            </span>
                            <span class="dropdown">
                                <a href="#" class="editable-toggle work-experience-input-display" data-menu="exp" @click="toggleRequest('exp')">без опыта работы</a>
                                <span class="dropdown-menu" :class="{'show': isRequestShown.exp}">
                                    <a class="dropdown-item" href="#">без опыта работы</a>
                                    <a class="dropdown-item" href="#">с опытом работы до 3 лет</a>
                                    <a class="dropdown-item" href="#">с опытом работы 3 или более года</a>
                                </span>
                            </span>
                            хочу
                            <span class="dropdown">
                                <a href="#" class="editable-toggle want-to-input" data-menu="want" @click="toggleRequest('want')">стать <span class="profession-title-tp"></span></a>
                                <span class="dropdown-menu" :class="{'show': isRequestShown.want}">
                                    <a class="dropdown-item" href="#">стать <span class="profession-title-tp"></span></a>
                                    <a class="dropdown-item" href="#">начать с нуля</a>
                                    <a class="dropdown-item" href="#">продолжить обучение</a>
                                    <a class="dropdown-item" href="#">повысить квалификацию</a>
                                    <a class="dropdown-item" href="#">прокачать навык</a>
                                </span>
                            </span>
                            <button class="btn btn-outline-info apply-request" style="display: none">Подобрать курсы</button>
                        </label>
                    </div>
                </section>
                <section class="fav-auth d-flex align-items-center">
                    <div class="d-flex align-items-center dropdown dropleft">
                        <button id="desktop-fav-btn" class="btn btn-favourites-list d-flex align-items-center justify-content-center mr-4" @click="toggleFavourites">
                            <label class="fav-text">Мои&nbsp;курсы</label>
                            <i class="fas fa-bookmark mx-2"></i>
                            <span class="fav-count">0</span>
                        </button>
                        <div class="dropdown-menu favourite-list p-4" aria-labelledby="desktop-fav-btn" :class="{'show': isFavouritesShown}"></div>
                        <div class="dropdown-backdrop" @click="toggleFavourites"></div>
                    </div>
                    <img src="/assets/images/avatar.svg" class="auth-trigger avatar-holder">
                    <a href="#" class="auth-triggrer btn btn-link authed-remove">Войти</a>
                </section>
            </div>
        </header>
        <div class="pr-4 pl-4 pb-4">
            <div class="container wide-container d-flex flex-row align-items-start">
                <section class="skills-section pr-4 pl-4 pb-4">
                    <section class="avatar d-flex flex-column align-items-center mb-4">
                        <img src="/assets/images/avatar.svg" class="auth-trigger">
                        <a href="#" class="auth-trigger user-name">Неопознанный Итчер</a>
                    </section>
                    <section class="existing-skills-data input-group mb-4">
                        <label class="group-title-label filter-group-title-label mb-0">
                            Мои профессиональные навыки
                        </label>
                        <div class="skills-filter-text mb-3">
                            фильтруют курсы по требованиям к знаниям
                        </div>

                        <div class="skills-input-wrapper">
                            <div class="existing-skills-input checkbox-group">
                                <skill v-for="skill in existingSkills" :skill="skill" :key="skill.title"></skill>
                            </div>
                            <span class="add-skill-wrapper form-inline d-inline-flex mt-2" style="display: none!important">
                                <input class="form-control add-skill-input add-existing-skill-input">
                            </span>
                            <button class="btn btn-outline-primary btn-with-plus btn-add-existing-skill">Добавить навык</button>
                        </div>
                    </section>
                    <section class="salary-data salary-input-wrapper mb-2 block-hidden">
                    </section>
                    <section class="skills-data input-group">
                        <label class="group-title-label skills-filter-text filter-group-title-label mb-0">
                            Недостающие проф. навыки на основе
                            <span class="skills-input-display editable-toggle">...</span>
                            с ЗП
                            <span class="salary-input-display editable-toggle">...</span>
                        </label>
                        <div class="skills-filter-text mb-3">
                            фильтруют по содержанию курсов
                        </div>

                        <div class="skills-input-wrapper">
                            <div class="skills-input checkbox-group">
                                <skill v-for="skill in neededSkills" :skill="skill" :key="skill.title"></skill>
                            </div>
                            <span class="add-skill-wrapper form-inline d-inline-flex mt-2" style="display: none!important">
                                <input class="form-control add-skill-input">
                            </span>
                            <button class="btn btn-outline-primary btn-with-plus btn-add-skill">Добавить навык</button>
                        </div>
                    </section>
                </section>
                <div class="flex-fill">
                    <section class="filter-panel">
                        <div class="d-flex flex-row flex-wrap margin-wrapper m-4">
                            <div class="d-flex flex-row flex-wrap mr-4">
                                <label class="d-inline mr-2 group-title-label">Формат курса</label>
                                <label class="btn btn-outline-primary btn-filter-apply">Интерактивный <input type="checkbox" value="Интерактивный" name="format[]"></label>
                                <label class="btn btn-outline-primary btn-filter-apply">Электронный учебник <input type="checkbox" value="Электронный учебник" name="format[]"></label>
                                <label class="btn btn-outline-primary btn-filter-apply">Вебинар <input type="checkbox" value="Вебинар" name="format[]"></label>
                                <label class="btn btn-outline-primary btn-filter-apply">Интенсив <input type="checkbox" value="Интенсив" name="format[]"></label>
                                <label class="btn btn-outline-primary btn-filter-apply">Видеокурс <input type="checkbox" value="Видеокурс" name="format[]"></label>
                            </div>

                            <div class="d-flex flex-row flex-wrap mr-4">
                                <label class="d-inline mr-2 group-title-label">Стоимость</label>
                                <label class="btn btn-outline-primary btn-filter-apply">Бесплатный <input type="checkbox" value="0" name="price"></label>
                                <label class="btn btn-outline-primary btn-filter-apply">Недорогой <input type="checkbox" value="1500" name="price"></label>
                            </div>

                            <div class="d-flex flex-row flex-wrap mr-4">
                                <label class="d-inline mr-2 group-title-label">Практика</label>
                                <label class="btn btn-outline-primary btn-filter-apply">Есть <input type="checkbox" value="1" name="hasPractice[]"></label>
                                <label class="btn btn-outline-primary btn-filter-apply">Нет <input type="checkbox" value="0" name="hasPractice[]"></label>
                            </div>

                            <div class="d-flex flex-row flex-wrap mr-4">
                                <label class="d-inline mr-2 group-title-label">Место проведения</label>
                                <label class="btn btn-outline-primary btn-filter-apply">Онлайн <input type="checkbox" value="Онлайн" name="format[]"></label>
                                <label class="btn btn-outline-primary btn-filter-apply">Вечерний <input type="checkbox" value="Вечерняя" name="format[]"></label>
                            </div>


                            <div class="d-flex flex-row more-group">
                                <label class="more-label" for="filter-more-button">Еще фильтры</label>
                            </div>

                            <div class="d-flex flex-row flex-wrap mr-4">
                                <label class="d-inline mr-2 group-title-label">Сертификат</label>
                                <label class="btn btn-outline-primary btn-filter-apply">Нет <input type="checkbox" value="Нет" name="certificate[]"></label>
                                <label class="btn btn-outline-primary btn-filter-apply">Собственный <input type="checkbox" value="Собственный" name="certificate[]"></label>
                                <label class="btn btn-outline-primary btn-filter-apply">Гос. образца <input type="checkbox" value="Государственного образца" name="certificate[]"></label>
                                <label class="btn btn-outline-primary btn-filter-apply">Международный <input type="checkbox" value="Международный" name="certificate[]"></label>
                            </div>

                            <div class="d-flex flex-row flex-wrap mr-4">
                                <label class="d-inline mr-2 group-title-label">Обучение с преподавателем</label>
                                <label class="btn btn-outline-primary btn-filter-apply">Да <input type="checkbox" value="1" name="hasTeacher[]"></label>
                                <label class="btn btn-outline-primary btn-filter-apply">Нет <input type="checkbox" value="0" name="hasTeacher[]"></label>
                            </div>

                            <div class="d-flex flex-row flex-wrap mr-4">
                                <label class="d-inline mr-2 group-title-label">Оказание помощи в трудоустройстве</label>
                                <label class="btn btn-outline-primary btn-filter-apply">Да <input type="checkbox" value="1" name="jobPlacement[]"></label>
                                <label class="btn btn-outline-primary btn-filter-apply">Нет <input type="checkbox" value="0" name="jobPlacement[]"></label>
                            </div>

                        </div>
                    </section>
                    <main class="no-result-hide course-list px-4"></main>
                    <section class="no-result-show no-result-text p-4 d-flex flex-column" style="display: none!important">
                        <h2>Ой! Такого не нашлось</h2>
                        <p class="flex-fill">Курсов, подходящих по условиям из фильтра, сейчас нет.</p>
                    </section>

                </div>
            </div>
            <footer></footer>
        </div>
    </div>

    <div class="view-on-mobile d-block d-sm-none d-md-none">
        <header class="avatar d-flex flex-column card p-4 top-drawer">
            <h5><a href="#" class="auth-trigger user-name">Неопознанный Итчер</a></h5>
            <div class="d-flex flex-row justify-content-between align-items-start">
                <div class="d-flex flex-row h-100 ">
                    <section class="data d-flex flex-column align-items-start h-100 flex-fill mr-2">
                        <div class="input-group">
                            <label class="request">
                                &mdash;&nbsp;Я
                                <span class="dropdown">
                                        <a href="#" class="editable-toggle mr-1" data-menu="profession" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">новичок</a>
                                        <span class="dropdown-menu">
                                            <a class="dropdown-item" href="#">новичок</a>
                                            <a class="dropdown-item profession-title" href="#">...</a>
                                            <a class="dropdown-item" href="#">специалист из другой области</a>
                                        </span>
                                    </span>
                                <span class="dropdown">
                                        <a href="#" class="editable-toggle work-experience-input-display" data-menu="exp" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">без опыта работы</a>
                                        <span class="dropdown-menu" >
                                            <a class="dropdown-item" href="#">без опыта работы</a>
                                            <a class="dropdown-item" href="#">с опытом работы до 3 лет</a>
                                            <a class="dropdown-item" href="#">с опытом работы 3 или более года</a>
                                        </span>
                                    </span>
                                хочу
                                <span class="dropdown">
                                    <a href="#" class="editable-toggle want-to-input" data-menu="want" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">стать <span class="profession-title-tp"></span></a>
                                    <span class="dropdown-menu">
                                        <a class="dropdown-item" href="#">стать <span class="profession-title-tp"></span></a>
                                        <a class="dropdown-item" href="#">начать с нуля</a>
                                        <a class="dropdown-item" href="#">продолжить обучение</a>
                                        <a class="dropdown-item" href="#">повысить квалификацию</a>
                                        <a class="dropdown-item" href="#">прокачать навык</a>
                                    </span>
                                </span>
                                <button class="btn btn-outline-info apply-request mt-2" style="display: none">Подобрать курсы</button>
                            </label>
                        </div>

                        <button class="btn btn-outline-info btn-block mt-4 btn-choose-skills">Выбрать навыки</button>

                        <div class="input-group salary-input-group">
                            <label class="">Желаемая зарплата:</label>
                            <a href="#" class="editable-toggle salary-input-display">...</a>
                        </div>
                    </section>
                    <section class="logo">
                        <img src="/assets/images/avatar.svg" class="auth-trigger">
                    </section>
                </div>
            </div>
            <div class="salary-input-wrapper">
            </div>
            <div class="profile-handle"></div>
        </header>
        <main>
            <section class="pagination d-flex flex-row justify-content-center align-items-center no-result-hide">
                <div class="swiper-button-prev"></div>
                <div class="swiper-pagination"></div>
                <div class="swiper-button-next"></div>
            </section>

            <section class="swiper-container no-result-hide">
                <div class="swiper-wrapper course-list loading">
                </div>
            </section>

            <section class="no-result-show no-result-text p-4 d-flex flex-column" style="display: none!important">
                <h2>Ой! Такого не нашлось</h2>
                <p class="flex-fill">Курсов, подходящих по условиям из фильтра, сейчас нет.</p>
                <button class="btn btn-outline-primary btn-outline-special apply-btn">
                    Изменить фильтр
                </button>
            </section>
        </main>
        <footer class="d-flex flex-row justify-content-center mb-4 p-2 no-result-hide">
            <button class="btn btn-favourites-list flex-fill d-flex align-items-center justify-content-center">
                <i class="fas fa-bookmark icon-background"></i>
                <i class="far fa-bookmark icon-overlay"></i>
                <span class="fav-count ml-2">0</span>
            </button>
            <div class="divisor"></div>
            <button class="btn btn-skills flex-fill"><i class="fas fa-graduation-cap"></i></button>
            <div class="divisor"></div>
            <button class="btn btn-filter flex-fill"><i class="fas fa-sliders-h"></i></button>
        </footer>
        <section class="skills-panel sliding-panel">
            <div class="margin-wrapper m-4">
                <div class="flex-row d-flex align-items-center justify-content-center mb-4 section-title">
                    <label class="flex-fill text-center mb-0">Навыки</label>
                    <a class="close-panel-btn" href="#">&times;</a>
                </div>

                <div class="existing-skills-data input-group mb-4">
                    <label class="group-title-label filter-group-title-label mb-0">
                        Мои профессиональные навыки
                    </label>
                    <div class="skills-filter-text mb-3">
                        фильтруют курсы по требованиям к знаниям
                    </div>

                    <div class="skills-input-wrapper">
                        <div class="existing-skills-input checkbox-group">
                            <skill v-for="skill in existingSkills" :skill="skill" :key="skill.title"></skill>
                        </div>
                        <span class="add-skill-wrapper form-inline d-inline-flex mt-2" style="display: none!important">
                                <input class="form-control add-skill-input add-existing-skill-input">
                            </span>
                        <button class="btn btn-outline-primary btn-with-plus btn-add-existing-skill">Добавить навык</button>
                    </div>
                </div>

                <div class="input-group">
                    <div class="salary-input-wrapper block-hidden">
                    </div>
                </div>

                <div class="input-group mb-4">
                    <label class="group-title-label filter-group-title-label">
                        Недостающие проф. навыки на основе
                        <span class="skills-input-display editable-toggle">...</span>
                        с ЗП
                        <span class="salary-input-display editable-toggle">...</span>
                    </label>
                    <label class="group-title-label skill-group-title-label mb-0">
                        Навыки для прокачки
                    </label>

                    <div class="skills-input-wrapper w-100">
                        <div class="skills-input checkbox-group">
                            <skill v-for="skill in neededSkills" :skill="skill" :key="skill.title"></skill>
                        </div>
                        <span class="add-skill-wrapper form-inline d-inline-flex mt-2" style="display: none!important">
                                <input class="form-control add-skill-input">
                            </span>
                        <button class="btn btn-outline-primary btn-with-plus btn-add-skill">Добавить навык</button>
                    </div>
                </div>

                <div class="d-flex flex-row justify-content-center mb-4 p-2">
                    <button class="btn btn-outline-primary btn-outline-special flex-fill d-flex align-items-center justify-content-center apply-btn">
                        Применить
                    </button>
                </div>
            </div>
        </section>
        <section class="filter-panel sliding-panel">
            <div class="margin-wrapper m-4">
                <div class="flex-row d-flex align-items-center justify-content-center mb-4 section-title">
                    <label class="flex-fill text-center mb-0">Фильтры</label>
                    <a class="close-panel-btn" href="#">&times;</a>
                </div>

                <div class="input-group">
                    <label class="group-title-label">Стоимость</label>
                    <div class="checkbox-group">
                        <label class="btn btn-outline-primary btn-filter-apply">Бесплатный <input type="checkbox" value="0" name="price"></label>
                        <label class="btn btn-outline-primary btn-filter-apply">Недорогой <input type="checkbox" value="1500" name="price"></label>
                    </div>
                </div>

                <div class="input-group">
                    <label class="group-title-label">Формат курса</label>
                    <div class="checkbox-group">
                        <label class="btn btn-outline-primary btn-filter-apply">Интерактивный <input type="checkbox" value="Интерактивный" name="format[]"></label>
                        <label class="btn btn-outline-primary btn-filter-apply">Электронный учебник <input type="checkbox" value="Электронный учебник" name="format[]"></label>
                        <label class="btn btn-outline-primary btn-filter-apply">Вебинар <input type="checkbox" value="Вебинар" name="format[]"></label>
                        <label class="btn btn-outline-primary btn-filter-apply">Интенсив <input type="checkbox" value="Интенсив" name="format[]"></label>
                        <label class="btn btn-outline-primary btn-filter-apply">Видеокурс <input type="checkbox" value="Видеокурс" name="format[]"></label>

                        <label class="btn btn-outline-primary btn-filter-apply">Онлайн <input type="checkbox" value="Онлайн" name="format[]"></label>
                        <label class="btn btn-outline-primary btn-filter-apply">Вечерний <input type="checkbox" value="Вечерняя" name="format[]"></label>
                    </div>
                </div>

                <div class="input-group">
                    <label class="group-title-label">Сертификат</label>
                    <div class="checkbox-group">
                        <label class="btn btn-outline-primary btn-filter-apply">Нет <input type="checkbox" value="Нет" name="certificate[]"></label>
                        <label class="btn btn-outline-primary btn-filter-apply">Собственный <input type="checkbox" value="Собственный" name="certificate[]"></label>
                        <label class="btn btn-outline-primary btn-filter-apply">Гос. образца <input type="checkbox" value="Государственного образца" name="certificate[]"></label>
                        <label class="btn btn-outline-primary btn-filter-apply">Международный <input type="checkbox" value="Международный" name="certificate[]"></label>
                    </div>
                </div>

                <div class="input-group">
                    <label class="group-title-label">Практика</label>
                    <div class="checkbox-group">
                        <label class="btn btn-outline-primary btn-filter-apply">Есть <input type="checkbox" value="1" name="hasPractice[]"></label>
                        <label class="btn btn-outline-primary btn-filter-apply">Нет <input type="checkbox" value="0" name="hasPractice[]"></label>
                    </div>
                </div>

                <div class="input-group">
                    <label class="group-title-label">Обучение с преподавателем</label>
                    <div class="checkbox-group">
                        <label class="btn btn-outline-primary btn-filter-apply">Да <input type="checkbox" value="1" name="hasTeacher[]"></label>
                        <label class="btn btn-outline-primary btn-filter-apply">Нет <input type="checkbox" value="0" name="hasTeacher[]"></label>
                    </div>
                </div>

                <div class="input-group">
                    <label class="group-title-label">Оказание помощи в трудоустройстве</label>
                    <div class="checkbox-group">
                        <label class="btn btn-outline-primary btn-filter-apply">Да <input type="checkbox" value="1" name="jobPlacement[]"></label>
                        <label class="btn btn-outline-primary btn-filter-apply">Нет <input type="checkbox" value="0" name="jobPlacement[]"></label>
                    </div>
                </div>

                <div class="d-flex flex-row justify-content-center mb-4 p-2">
                    <button class="btn btn-outline-primary btn-outline-special flex-fill d-flex align-items-center justify-content-center apply-btn">
                        Применить
                    </button>
                </div>
            </div>
        </section>
        <section class="favourite-panel sliding-panel">
            <div class="margin-wrapper m-4">
                <div class="flex-row d-flex align-items-center justify-content-center mb-4 section-title">
                    <label class="flex-fill text-center mb-0">Сохраненные курсы</label>
                    <a class="close-panel-btn" href="#">&times;</a>
                </div>

                <div class="favourite-list">

                </div>
            </div>
        </section>
    </div>

    <div class="modal fade" id="surveyModal" tabindex="-1" role="dialog" aria-labelledby="surveyModalLabel" aria-hidden="true">
        <div class="modal-dialog" role="document">
            <div class="modal-content">
                <div class="modal-header">
                    <h5 class="modal-title" id="surveyModalLabel">Отзыв о курсе</h5>
                    <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                        <span aria-hidden="true">&times;</span>
                    </button>
                </div>
                <div class="modal-body p-0 survey-data">
                    <div class="d-flex flex-column align-items-center text-center">
                        <img src="/assets/images/avatar_facebook.png" class="auth-trigger itcher-avatar mt-4 mb-4">
                        <button class="btn btn-outline-info auth-trigger mt-4">Пожалуйста, представьтесь</button>
                        <p>Мы переживаем за качество отзывов</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>

<template id="skill-template">
    <label
        class="btn btn-outline-primary btn-skill-toggle skill"
        :class="{'user-added': skill.userAdded, 'system-added': !skill.userAdded, 'active': skill.checked}"
        :data-rate="skill.rate"
    >
        {{skill.title}}
        <span class="skill-strength" :class="['level'+skill.level]"><span></span><span></span><span></span><span></span></span>
        <input
            type="checkbox"
            :name="'skills['+skill.title+']'"
            :value="skill.level"
            v-model="skill.checked"
        >
    </label>
</template>


<script src="https://code.jquery.com/jquery-3.2.1.min.js"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.12.9/umd/popper.min.js"
        integrity="sha384-ApNbgh9B+Y1QKtv3Rn7W3mgPxhU9K/ScQsAP7hUibX39j7fakFPskvXusvfa0b4Q"
        crossorigin="anonymous"></script>
<script src="https://maxcdn.bootstrapcdn.com/bootstrap/4.0.0/js/bootstrap.min.js"
        integrity="sha384-JZR6Spejh4U02d8jOt6vLEHfe/JQGiRRSQQxSfFWpi1MquVdAyjUar5+76PVCmYl"
        crossorigin="anonymous"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/Swiper/4.4.5/js/swiper.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/interactjs@1.3.4/dist/interact.min.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/svg.js/2.7.1/svg.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/js-cookie@2/src/js.cookie.min.js"></script>
<script src="https://twitter.github.io/typeahead.js/releases/latest/typeahead.bundle.js"></script>
<script src="https://cdn.auth0.com/js/auth0/9.10/auth0.min.js"></script>
<script src="https://www.gstatic.com/firebasejs/6.1.0/firebase.js"></script>
<script src="https://surveyjs.azureedge.net/1.0.89/survey.jquery.min.js"></script>
<script src="/assets/courseFunctions.js"></script>
<script src="/assets/js/auth.js"></script>
<script src="/assets/js/share.js"></script>
<script src="/assets/js/firebase.js"></script>
<script src="/assets/js/feedback.js"></script>
<script src="/design/histogramInput.js"></script>

<script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script>
<script src="/assets/js/vue/courses.js"></script>

<!-- BEGIN JIVOSITE CODE {literal} -->
<script type='text/javascript'>
    (function(){ var widget_id = 'undd9PhcEl';var d=document;var w=window;function l(){
        var s = document.createElement('script'); s.type = 'text/javascript'; s.async = true;
        s.src = '//code.jivosite.com/script/widget/'+widget_id
        ; var ss = document.getElementsByTagName('script')[0]; ss.parentNode.insertBefore(s, ss);}
        if(d.readyState=='complete'){l();}else{if(w.attachEvent){w.attachEvent('onload',l);}
        else{w.addEventListener('load',l,false);}}})();
</script>
<!-- {/literal} END JIVOSITE CODE -->

<script>
    let currentCourses = false;

    function getMobileCourseHTML(course) {
        let description = splitLongText(course.description);
        let searchedSkillsHTML = course.searchedSkills ? getSkillsHTML(course.searchedSkills) : false;
        let additionalSkillsHTML = course.additionalSkills ? getSkillsHTML(course.additionalSkills) : false;
        let allSkillsHTML = course.skills ? getSkillsHTML(course.skills) : false;
        let requirementsHTML = course.requirements ? getSkillsHTML(course.requirements) : false;
        let isFavourited = isInBackpack(course.id);

        return `<div class="swiper-slide card course-card ${course.hasPartnerUrl ? 'take-a-look' : ''}">
                <div class="card-body" data-id="${course.id}">
                    <div class="d-flex flex-row align-items-center course-card-header">
                        <span class="badge badge-course-info mr-2">Курс</span>
                        <h6 class="text-muted flex-fill mb-0">от <a href="${getCourseUrl(course)}">${course.platform}</a></h6>
                        <a href="#" class="top-favourite-add">
                            <i class="${isFavourited ? 'fas' : 'far'} fa-bookmark"></i>
                        </a>
                    </div>
                    <h5>${course.title}</h5>

                    <p class="mt-0 mb-0 price">${getCoursePriceText(course.price)}</p>
                    <p class="mt-0 text-muted">${getCourseTime(course)} &asymp; ${getHumanReadableTime(course)}</p>

                    <p class="mt-1 text-info">${getCourseAttributesHTML(course)}</p>

                    ${searchedSkillsHTML
                        ? (
                            '<label class="mt-1 mb-0">По окончании будете уметь</label><p>' + searchedSkillsHTML +
                            (additionalSkillsHTML ? '<a href="#" class="continue-toggle">Показать все</a><span class="continue" style="display: none">' + additionalSkillsHTML + '</span>' : '') +
                            '</p>'
                        )
                        : '<label class="mt-1 mb-0">По окончании будете уметь</label><p>' + allSkillsHTML + '</p>'
                    }

                    ${requirementsHTML ? '<label class="mt-1 mb-0">Нужно знать</label><p>' + requirementsHTML + '</p>' : ''}

                    <p id="description${course.id}" class="">
                        ${description[0]}
                        ${description[1] ?
                            '<span class="continue-dots">...</span>' +
                            '<a href="#" class="continue-toggle d-flex justify-content-end flex-column"><i class="fas fa-angle-down"></i></a>' +
                            '<span class="continue" style="display: none">' + description[1] + '</span>'
                            : ''}
                    </p>
                    <a href="${getCoursePageUrl(course)}" target="_blank" class="details-link" data-course-id="${course.id}">Подробнее на странице курса</a>

                    <div class="course-buttons flex-fill d-flex flex-row mt-4">
                        <a href="${getCourseUrl(course)}" class="btn btn-outline-info flex-fill d-flex justify-content-center btn-link mr-2" data-course-id="${course.id}">
                            Записаться
                        </a>
                        <button class="btn btn-outline-info d-flex flex-row btn-favourite mr-2 ${isFavourited ? 'active' : ''}" ${isFavourited ? 'disabled="disabled"' : '' }>
                            <i class="${isFavourited ? 'fas fa-check' : 'far fa-bookmark'}"></i>
                        </button>
                            <button class="btn btn-outline-info btn-feedback mr-2" data-toggle="modal" data-target="#surveyModal">
                                <i class="far fa-comment"></i>
                            </button>
                        <button class="btn btn-outline-info btn-share mr-2" data-course-id="${course.id}">
                            <i class="fas fa-share-alt"></i>
                            <ul class="share-menu dropdown-menu">
                                <li class="dropdown-item"><a href="#" data-social="vkontakte">Вконтакте</a></li>
                                <li class="dropdown-item"><a href="#" data-social="facebook">Facebook</a></li>
                                <li class="dropdown-item"><a href="#" data-social="twitter">Twitter</a></li>
                                <li class="dropdown-item"><a href="#" data-social="whatsapp">WhatsApp</a></li>
                                <li class="dropdown-item"><a href="#" data-social="telegram">Telegram</a></li>
                            </ul>
                        </button>
                    </div>
                </div>
            </div>`;
    }

    function getDesktopCourseHTML(course) {
        let description = splitLongText(course.description, 50);
        let searchedSkillsHTML = course.searchedSkills ? getSkillsHTML(course.searchedSkills) : false;
        let additionalSkillsHTML = course.additionalSkills ? getSkillsHTML(course.additionalSkills) : false;
        let allSkillsHTML = course.skills ? getSkillsHTML(course.skills) : false;
        let requirementsHTML = course.requirements ? getSkillsHTML(course.requirements) : false;
        let isFavourited = isInBackpack(course.id);

        return `
            <div class="card course-card ${course.hasPartnerUrl ? 'take-a-look' : ''}">
                <div class="card-body" data-id="${course.id}">
                    <div class="d-flex flex-row justify-content-between align-items-start">
                        <span class="badge badge-course-info">Курс</span>
                        <div class="d-flex flex-row justify-content-end course-card-header">
                            <h6 class="text-muted">от <a href="${getCourseUrl(course)}">${course.platform}</a></h6>
                            <a href="#" class="top-favourite-add">
                                <i class="${isFavourited ? 'fas' : 'far'} fa-bookmark"></i>
                            </a>
                        </div>
                    </div>
                    <h5>${course.title}</h5>
                    <p class="mt-1">${getCourseTime(course)} &asymp; ${getHumanReadableTime(course)}</p>
                    <p class="mt-1 text-info">${getCourseAttributesHTML(course)}</p>

                    ${searchedSkillsHTML
                            ? (
                                '<label class="mt-1 mb-0">По окончании будете уметь</label><p>' + searchedSkillsHTML +
                                (additionalSkillsHTML ? '<a href="#" class="continue-toggle">Показать все</a><span class="continue" style="display: none">' + additionalSkillsHTML + '</span>' : '') +
                                '</p>'
                            )
                            : '<label class="mt-1 mb-0">По окончании будете уметь</label><p>' + allSkillsHTML + '</p>'
                            }

                    ${requirementsHTML ? '<label class="mt-1 mb-0">Нужно знать</label><p>' + requirementsHTML + '</p>' : ''}

                    <p id="description${course.id}" class="">
                        ${description[0]}
                        ${description[1] ?
                            '<span class="continue-dots">...</span>' +
                            '<a href="#" class="continue-toggle d-flex justify-content-end flex-column"><i class="fas fa-angle-down"></i></a>' +
                            '<span class="continue" style="display: none">' + description[1] + '</span>'
                            : ''
                        }
                    </p>
                    <a href="${getCoursePageUrl(course)}" class="details-link" data-course-id="${course.id}">Подробнее на странице курса</a>

                    <div class="row mt-4">
                        <div class="col price-duration-data">
                            <p class="mt-0 mb-0 price">${getCoursePriceText(course.price)}</p>
                        </div>
                        <div class="col course-buttons d-flex flex-row mt-1">
                            <button class="btn btn-outline-info d-flex flex-row btn-favourite mr-2 ${isFavourited ? 'active' : ''}" ${isFavourited ? 'disabled="disabled"' : '' }>
                                <i class="${isFavourited ? 'fas fa-check' : 'far fa-bookmark'}"></i>
                            </button>
                            <button class="btn btn-outline-info btn-feedback mr-2" data-toggle="modal" data-target="#surveyModal">
                                <i class="far fa-comment"></i>
                            </button>
                            <button class="btn btn-outline-info btn-share mr-2" data-course-id="${course.id}" id="share${course.id}">
                                <i class="fas fa-share-alt"></i>
                                <ul class="share-menu dropdown-menu" aria-labelledby="share${course.id}">
                                    <li class="dropdown-item"><a href="#" data-social="vkontakte">Вконтакте</a></li>
                                    <li class="dropdown-item"><a href="#" data-social="facebook">Facebook</a></li>
                                    <li class="dropdown-item"><a href="#" data-social="twitter">Twitter</a></li>
                                    <li class="dropdown-item"><a href="#" data-social="whatsapp">WhatsApp</a></li>
                                    <li class="dropdown-item"><a href="#" data-social="telegram">Telegram</a></li>
                                </ul>
                            </button>
                            <a href="${getCourseUrl(course)}" class="btn btn-outline-info flex-fill btn-link mr-2" data-course-id="${course.id}">
                                Записаться
                            </a>
                        </div>
                    </div>
                </div>
            </div>`;
    }

    function initSlider() {
        window.swiper = new Swiper('.swiper-container', {
            slidesPerView: 'auto',
            centeredSlides: true,
            spaceBetween: 12,
            pagination: {
                el: '.swiper-pagination',
                type: 'fraction',
            },
            navigation: {
                nextEl: '.swiper-button-next',
                prevEl: '.swiper-button-prev',
            },
        });

        return window.swiper;
    }

    function clearAndHideSkillAdd(elem) {
        if (!elem) {
            elem = '.add-skill-input';
        }

        $(elem).typeahead('val', '');
        hideSkillAdd(elem);
    }

    function hideSkillAdd(inputEl) {
        let inputTemplate = getInputTemplateCode();
        if (inputTemplate !== 'skill') {
            $(inputEl).closest('.add-skill-wrapper').attr("style", "display: none!important");
        }
    }

    function showSkillAdd() {
        $(this).siblings('.add-skill-wrapper').attr('style', '');
    }

    function initSkillAdd() {
        let inputTemplate = getInputTemplateCode();

        if (inputTemplate === 'skill') {
            $('.add-skill-wrapper').attr('style', '');
        }


        loadProfessionSkills()
            .then(function (skills) {
                $('.add-skill-input').typeahead(null, {
                    name: 'skills',
                    source: function (query, syncResults, asyncResults) {
                        let results = skills.reduce(function (foundSkills, skillData) {
                            let lcQuery = query.toLowerCase();
                            let lcName = skillData.name.toLowerCase();

                            if (lcName.indexOf(lcQuery) != -1) {
                                foundSkills.push(skillData.name);
                            }

                            return foundSkills;
                        }, []);
                        syncResults(results);
                    }
                });
            });

        $(document).on('typeahead:select typeahead:change', '.add-skill-input, .add-existing-skill-input', function (event, skillName) {
            if (skillName === '') {
                return;
            }

            let addToExistingSkills = $(event.currentTarget).hasClass('add-existing-skill-input');

            if (addToExistingSkills) {
                vueInstance.addExistingSkill(skillName);
            }
            else {
                vueInstance.addNeededSkill(skillName);
            }

            clearAndHideSkillAdd(this);
        });

        $(document).on('click', '.btn-add-skill, .btn-add-existing-skill', showSkillAdd);
    }

    function updateSlider() {
        window.swiper.update();
    }

    function initTopDrawerSliding() {
        let начальнаяВысотаЗаголовка = $('.view-on-mobile header').outerHeight()-3;
        let максимальнаяВысотаЗаголовка = 290;
        $('header').data('closed-height', начальнаяВысотаЗаголовка);

        interact('header')
            .resizable({
                edges: { bottom: true },
                restrictSize: {
                    min: { height: начальнаяВысотаЗаголовка },
                    max: { height: максимальнаяВысотаЗаголовка}
                },
                inertia: true
            })
            .on('resizemove', function (событие) {
                let заголовок = событие.target;
                заголовок.classList.remove('expanded');
                заголовок.classList.remove('animated');
                let новаяВысотаЗаголовка = событие.rect.height;
                заголовок.style.height = новаяВысотаЗаголовка + 'px';
            });
    }

    function hideFooter() {
        $('footer').css('visibility', 'hidden');
    }

    function toggleFooter() {
        let $footer = $('footer');
        let isFooterVisible = $footer.css('visibility') !== 'hidden';

        if (isFooterVisible) {
            hideFooter();
        }
        else {
            showFooterIfNeeded();
        }
    }

    function activateCheckbox(selector) {
        let $checkbox = $(selector);
        let $pill = $checkbox.closest('.btn')

        $checkbox.attr('checked', true);
        $pill.addClass('active');
    }

    function setTemplateFilterValues() {
        let inputTemplate = getInputTemplateCode();

        if (inputTemplate === 'novice') {
            //activateCheckbox('input[name="price"][value="0"]');
            activateCheckbox('input[name="hasPractice[]"][value="1"]');
        }

        if (inputTemplate === 'other-novice') {
            //activateCheckbox('input[name="price"][value="1500"]');
            activateCheckbox('input[name="hasPractice[]"][value="1"]');
        }
    }

    function initFilter() {
        setTemplateFilterValues();

        $(document).on('click', '.btn-filter', function () {
            $('.filter-panel').toggleClass('show');
            toggleFooter();
        });

        $(document).on('click', '.btn-choose-skills', function () {
            $('.skills-panel').toggleClass('show');
            toggleFooter();
        });

        $(document).on('click', ' .filter-panel .close-panel-btn, .filter-panel .apply-btn', function () {
            $('.filter-panel').toggleClass('show');
            showFooterIfNeeded();
        });

        $(document).on('click', '.no-result-text .apply-btn', function () {
            $('.filter-panel').toggleClass('show');
        });

        $(document).on('click', '.checkbox-group:not(.skills-input, .existing-skills-input) input, .filter-panel input', function() {
            $(this).closest('label').toggleClass('active');
            debouncedUpdateCourses();
        });

        $(document).on('click', '.more-group', function () {
            $(this).closest('.filter-panel').toggleClass('expanded');
        });
    }

    function initFavourites() {
        $(document).on('click', '.btn-favourites-list:not(.view-on-desktop .btn-favourites-list)', function () {
            $('.favourite-panel').toggleClass('show');
            toggleFooter();
        });

        $(document).on('click', '.favourite-panel .close-panel-btn, .favourite-panel .apply-btn ', function () {
            $('.favourite-panel').toggleClass('show');
            showFooterIfNeeded();
        });
    }

    function displaySalaryRange(salaryFrom, salaryTo) {
        let fromThousands = Math.round(salaryFrom / 1000);
        let toThousands = Math.round(salaryTo / 1000);

        $('.salary-input').data('from', salaryFrom);
        $('.salary-input').data('to', salaryTo);

        $('.salary-input-display').html(formatNumber(fromThousands) + 'k&nbsp;&mdash;&nbsp;'+formatNumber(toThousands)+'k&nbsp;&#8381;');
    }

    function debounce(func, wait, immediate) {
        //https://frontender.info/essential-javascript-functions/
        let timeout;
        return function() {
            let context = this, args = arguments;
            let later = function() {
                timeout = null;
                if (!immediate) func.apply(context, args);
            };
            let callNow = immediate && !timeout;
            clearTimeout(timeout);
            timeout = setTimeout(later, wait);
            if (callNow) func.apply(context, args);
        };
    }

    function matchAttr(attrValue, value) {
        if (attrValue instanceof Array) {
            return attrValue.indexOf(value) !== -1;
        }

        if (attrValue !== false) {
            return attrValue === value;
        }

        return true;
    }

    function matchRule(rule, who, experience, wish) {
        return matchAttr(rule.who, who) && matchAttr(rule.experience, experience) && matchAttr(rule.wish, wish);
    }

    function getInputTemplate(templateCode) {
        if (!templateCode) {
            templateCode = getInputTemplateCode();
        }

        let templates = {
            'novice': {
                skillRateFilter: {
                    existing: false,
                    needed: [35, 100]
                }
            },
            'novice-continue': {
                skillRateFilter: {
                    existing: [80, 100],
                    needed: [35, 80]
                }
            },
            'other-novice': {

            },
            'other-novice-continue': {
                skillRateFilter: {
                    existing: [80, 100],
                    needed: [35, 80]
                }
            },
            'skill': {
                skillRateFilter: {
                    existing: false,
                    needed: false
                }
            },
            'middle-continue': {
                skillRateFilter: {
                    existing: [70, 100],
                    needed: [15, 70]
                }
            },
            'senior-continue': {
                skillRateFilter: {
                    existing: [70, 100],
                    needed: [0, 70]
                }
            }
        };

        return templates[templateCode] || false;
    }

    function isSkillExisting(skillRate, templateCode) {
        let template = getInputTemplate(templateCode);
        if (!template) {
            return false;
        }

        if (!template.skillRateFilter.existing) {
            return false;
        }

        let fromRate = template.skillRateFilter.existing[0];
        let toRate = template.skillRateFilter.existing[1];

        return  skillRate > fromRate && skillRate <= toRate;
    }

    function isSkillNeeded(skillRate, templateCode) {
        let template = getInputTemplate(templateCode);
        if (!template) {
            return true;
        }

        if (!template.skillRateFilter.needed) {
            return false;
        }

        let fromRate = template.skillRateFilter.needed[0];
        let toRate = template.skillRateFilter.needed[1];

        return  skillRate > fromRate && skillRate <= toRate;
    }

    function getInputTemplateCode() {
        let request = getRequestValuesFromURL();
        let who = request[0];
        let experience = request[1];
        let wish = request[2];
        let professionName = getCurrentProfessionName();

        let defaultTemplate = 'novice';

        let templateRules = [
            {
                who: 'новичок',
                experience: false,
                wish: false,
                template: 'novice',
                score: 0
            },
            {
                who: 'новичок',
                experience: false,
                wish: ['продолжить обучение', 'повысить квалификацию'],
                template: 'novice-continue',
                score: 10
            },
            {
                who: 'специалист из другой области',
                experience: false,
                wish: false,
                template: 'other-novice',
                score: 0
            },
            {
                who: 'специалист из другой области',
                experience: false,
                wish: ['продолжить обучение', 'повысить квалификацию'],
                template: 'other-novice-continue',
                score: 10
            },
            {
                who: false,
                experience: false,
                wish: 'прокачать навык',
                template: 'skill',
                score: 100
            },
            {
                who: false,
                experience: false,
                wish: 'начать с нуля',
                template: 'novice',
                score: 100
            },
            {
                who: professionName,
                experience: ['с опытом работы до 3 лет', 'с небольшим опытом работы'],
                wish: false,
                template: 'middle-continue',
                score: 50
            },
            {
                who: professionName,
                experience: ['с опытом работы 3 или более года', 'с большим опытом работы'],
                wish: false,
                template: 'senior-continue',
                score: 50
            }
        ];

        let finalRule = templateRules.reduce(function (matchedRule, rule) {
            let isScoreGreater = (matchedRule && matchedRule.score < rule.score) || (!matchedRule);
            return matchRule(rule, who, experience, wish) && isScoreGreater
                ? rule
                : matchedRule;
        }, false);

        return finalRule
            ? finalRule.template
            : defaultTemplate;
    }

    function getRequestValuesFromURL() {
        let who = getParameterByName('who');
        let experience = getParameterByName('experience');
        let wish = getParameterByName('wish');
        let isRequestNotEmpty = Boolean(who) && Boolean(experience) && Boolean(wish);

        return isRequestNotEmpty ? [who, experience, wish] : false;
    }

    function updateRequestValuesFromURL() {
        let request = getRequestValuesFromURL();

        if (request) {
            ['profession', 'exp', 'want'].forEach((menuName, menuIndex) => {
                $('.request [data-menu="' + menuName + '"]').each((index, menuToggle) => {
                    $(menuToggle).text(request[menuIndex]);
                });
            });
        }
    }

    function initHeaderInputs() {
        let updateSkillsAndCourses = debounce(function () {
            updateSkills()
                .then(updateCourses);
        }, 500);

        $(document).on('click', '.request .dropdown-item', function () {
            let itemText = $(this).text();
            let $toggle = $(this).closest('.dropdown').find('.editable-toggle');
            let menuCode = $toggle.data('menu');
            let $allToggles = $('[data-menu="'+menuCode+'"');
            let $applyButtons = $('.apply-request');

            $allToggles.text(itemText);
            $applyButtons.show();

            vueInstance.toggleRequest(menuCode);
        });

        $(document).on('click', '.apply-request', function () {
            let request = getRequestValuesFromDOM();

            let newUrl = new URL(location.href);
            newUrl.searchParams.set('who', request[0]);
            newUrl.searchParams.set('experience', request[1]);
            newUrl.searchParams.set('wish', request[2]);

            location.href = newUrl.toString();
        });

        $('.salary-input').on('changeFrom changeTo', function (event) {
            let salaryFrom = $(this).data('from') || 0;
            let salaryTo = $(this).data('to') || 0;

            if (event.type === 'changeFrom') {
                salaryFrom = Math.round(event.originalEvent.value);
            }
            else {
                salaryTo = Math.round(event.originalEvent.value);
            }

            displaySalaryRange(salaryFrom, salaryTo);
            updateSkillsAndCourses();
        });

        $(document).on('click', '.view-on-mobile .editable-toggle.salary-input-display', function () {
            let isHeaderExpanded = $('header').hasClass('expanded');

            if (isHeaderExpanded) {
                collapseHeader();
            }
            else {
                expandHeader();
            }
        });

        $(document).on('click', '.delete-skill, .delete-skill-mobile', function () {
            let $skillElement = $(this).closest('.skill');
            $skillElement.remove();
            debouncedUpdateCourses();
        });
    }

    function loadHistogramData() {
        return loadApiData('/api/histogramData.php', {professionCode: getProfessionCodeFromUrl()});
    }

    function loadProfessionSkills() {
        return loadApiData('/api/skills.php', {format: 'json'})
            .then(function (response) {
                let professionName = getCurrentProfessionName();
                let ucProfessionName = professionName[0].toUpperCase() + professionName.slice(1);
                return response[ucProfessionName];
            });
    }

    function loadSkillsData(salaryFrom, salaryTo) {
        let inputTemplate = getInputTemplateCode();
        let filterRate = 10;

        if (inputTemplate === 'middle-continue' || inputTemplate === 'senior-continue') {
            filterRate = 0;
        }

        return loadApiData('/api/vacancySkillsBySalary.php', {
            professionCode: getProfessionCodeFromUrl(),
            salaryFrom: salaryFrom,
            salaryTo: salaryTo,
            filterRate: filterRate
        });
    }

    function loadCourses() {
        let isMobile = $('.view-on-mobile').is(':visible');
        let searchFields = isMobile
            ? $('.view-on-mobile .skills-input input, .view-on-mobile .filter-panel input').serializeArray()
            : $('.view-on-desktop .skills-input input, .view-on-desktop .filter-panel input').serializeArray();
        searchFields.push({name: "professionCode", value: getProfessionCodeFromUrl()});
        searchFields.push({name: "searchMode", value: 1});
        searchFields.push({name: "responseFormat", value: "json"});

        return loadApiData('/api/coursesList.php', searchFields).then(function (response) {
            currentCourses = response;
            return response;
        });
    }

    function getCoursesList() {
        return currentCourses;
    }

    function makeSalaryInput(wrapperSelector, width, height) {
        let wrappers = document.querySelectorAll(wrapperSelector);
        let inputTemplate = getInputTemplateCode();

        return loadHistogramData()
            .then(function (response) {
                let salaryFrom = response.salary.from.median;
                let salaryTo = response.salary.to.median;

                if (inputTemplate === 'novice' || inputTemplate === 'other-novice') {
                    salaryFrom = response.salary.min;
                    salaryTo = response.salary.to.q25;
                }

                if (inputTemplate === 'middle-continue') {
                    salaryFrom = response.salary.from.q25;
                    salaryTo = response.salary.to.q75;
                }

                if (inputTemplate === 'senior-continue') {
                    salaryFrom = response.salary.from.q75;
                    salaryTo = response.salary.max;
                }

                if (salaryFrom === salaryTo) {
                    salaryFrom -= response.step;
                }

                wrappers.forEach(function (wrapper) {
                    new SalaryInput(wrapper, {
                        fromHandle: salaryFrom,
                        toHandle: salaryTo,
                        graphWidth: width,
                        graphHeight: height,
                        handleHeight: 53,
                        binValues: response.binValues,
                        labelsText: response.binLabels,
                        valueRange: [response.salary.min, response.salary.max]
                    });
                });

                displaySalaryRange(salaryFrom, salaryTo);
            });
    }

    function drawSkills(response) {
        let inputTemplateCode = getInputTemplateCode();
        if (inputTemplateCode === 'skill') {
            return;
        }

        let displayText = response.vacanciesCount+ ' ' +
            declensionUnits( response.vacanciesCount, 'вакансий');


        $('.skills-input-display').html(displayText);

        let skills = response.skills.map((skill) => {
            skill.level = skill.modeLevel;
            return skill;
        });

        let existingSkills = skills.filter((skill) => isSkillExisting(skill.rate, inputTemplateCode) );
        let notExistingSkills = skills.filter((skill) => !isSkillExisting(skill.rate, inputTemplateCode) );

        let urlSkills = getParameterByName('skills[]');
        let hasUrlSkills = Boolean(urlSkills);

        existingSkills = existingSkills.map((skill) => {
            skill.userAdded = false;
            skill.checked = true;

            return skill;
        });

        notExistingSkills = notExistingSkills.map((skill) => {
            skill.userAdded = false;
            skill.checked = hasUrlSkills ? false : isSkillNeeded(skill.rate);

            return skill;
        });

        vueInstance.neededSkills = notExistingSkills;
        vueInstance.existingSkills = existingSkills;

        if (hasUrlSkills) {
            urlSkills.forEach((title) => {
                vueInstance.addNeededSkill(title);
            });
        }
    }

    function drawCourses(response) {
        response.forEach(function (course) {
            let mobileHTML = getMobileCourseHTML(course);
            let desktopHTML = getDesktopCourseHTML(course);

            $('.view-on-mobile .course-list').append(mobileHTML);
            $('.view-on-desktop .course-list').append(desktopHTML);
        });

        updateSlider();
    }

    function updateSkills() {
        $('.skills-input').addClass('loading');
        $('.skills-input .system-added').remove();

        return loadSkillsData($('.salary-input').data('from'), $('.salary-input').data('to'))
            .then(function (response) {
                $('.skills-input').removeClass('loading');
                drawSkills(response);
            });
    }

    function showNoResults() {
        $('.no-result-show').attr("style", "");
        $('.no-result-hide').attr("style", "display: none!important");
        if (isFilterPanelActive()) {
            hideFooter();
        }
    }

    function hideNoResults() {
        $('.no-result-show').attr("style", "display: none!important");
        $('.no-result-hide:not(.filter-panel, footer)').attr("style", "");

        showFooterIfNeeded();
    }

    function updateCourses() {
        $('.course-list').addClass('loading').html('');

        return loadCourses()
            .then(function (response) {
                let noCourses = response.length === 0;

                $('.course-list').removeClass('loading');

                if (noCourses) {
                    showNoResults();
                }
                else {
                    hideNoResults();
                }

                drawCourses(response);
            });
    }

    let debouncedUpdateCourses = debounce(updateCourses, 1500);

    function expandHeader() {
        let maxHeight = 290;
        $('header')
            .addClass('expanded animated')
            .css('height', maxHeight+'px');
    }

    function collapseHeader() {
        $('header')
            .removeClass('expanded')
            .css('height', $('header').data('closed-height')+'px');
    }

    function updatePageTitle() {
        $('.profession-title').text( getCurrentProfessionName() );
        $('.profession-title-tp').text( getCurrentProfessionName(false, true) );
    }

    function initSkills() {
        let inputTemplate = getInputTemplateCode();

        if (inputTemplate === 'skill') {
            $('section.skills-section, section.filter-panel, header.top-drawer').addClass('manual-skills');
        }

        $(document).on('click', '.btn-skills', function () {
            $('.skills-panel').toggleClass('show');
            toggleFooter();
        });

        $(document).on('click', ' .skills-panel .close-panel-btn, .skills-panel .apply-btn', function () {
            $('.skills-panel').toggleClass('show');
            showFooterIfNeeded();
        });

        $(document).on('click', '.skills-filter-text .editable-toggle', () => $('.salary-data').toggleClass('block-hidden'));
        $(document).on('click', '.filter-group-title-label .editable-toggle', () => $('.skills-panel .salary-input-wrapper').toggleClass('block-hidden'));
    }

    (function chromeOnAndroidUrlBarOverlayHack() {
        if (navigator.userAgent.indexOf("Chrome") !== -1 && navigator.userAgent.indexOf("Android") !== -1) {
            document.body.classList.add('chrome-on-android');
        }
    })();

    $(function () {
        let graphWidth = 260;
        let graphHeight = 55;

        initScroll();
        initAuth();
        updatePageTitle();
        updateRequestValuesFromURL();
        initFilter();
        initSkills();
        initSlider();
        initTopDrawerSliding();

        checkSession()
            .then(showProfile);

        makeSalaryInput('.salary-input-wrapper', graphWidth, graphHeight)
            .then(updateSkills)
            .then(updateCourses)
            .then(updateFavourites)
            .then(initHeaderInputs)
            .catch((err) => { err ? console.warn(err) : console.log('undefined err'); });

        initSkillAdd();
        initFavourites();
        initCourseCards();
    });

</script>

</body>
</html>